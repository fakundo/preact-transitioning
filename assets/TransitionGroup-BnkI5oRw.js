import{H as m,t as E,_ as w,K as y,k as _}from"./preact.module-CLNnjL5T.js";import{A as h,_ as b}from"./hooks.module-Bqmbac_-.js";import{D}from"./CSSTransition-D2FYEyZ0.js";function C(T){const{children:A,appear:I=!1,enter:a=!0,exit:u=!0,duration:c=D}=T,p=h(!1),d=h([]),f=[],l=[],x={},o=[];m(A).forEach(t=>{E(t)&&(x[t.key]=o.length,o.push(t))});const r=(t,e)=>{const n=y(t,{in:!e,alwaysMounted:!1,exit:t.props.exit??u,enter:t.props.enter??a,duration:t.props.duration??c,appear:p.current?t.props.enter??a:t.props.appear??I});f.push({element:t,removeTimeout:e}),l.push(n)},k=t=>window.setTimeout(()=>{const{current:e}=d,n=e.findIndex(({element:s})=>s.key===t.key);n>=0&&e.splice(n,1)},t.props.duration??c);let i=0;d.current.forEach(({element:t,removeTimeout:e})=>{const n=x[t.key]??-1;if(n<0)e?r(t,e):(t.props.exit??u)&&r(t,k(t));else{e&&window.clearTimeout(e);for(let s=i;s<=n;s+=1)r(o[s])}i=Math.max(i,n+1)});for(let t=i;t<o.length;t+=1)r(o[t]);return b(()=>{p.current=!0},[]),d.current=f,w(_,{},l)}export{C as T};
